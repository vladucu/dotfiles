#!/bin/bash
# Install common macOS packages

source /tmp/chezmoi-utils.sh
set -eufo pipefail

printf "${green}\n[10 - macOS] ${reset}"
echo "Installing common macOS packages"

{{- $brew := or (lookPath "/opt/homebrew/bin/brew") (lookPath "/usr/local/bin/brew") }}

{{ $brew }} bundle --no-lock --file=/dev/stdin <<EOF
{{ range (.packages.darwin.taps | sortAlpha | uniq) -}}
tap {{ . | quote }}
{{ end -}}

{{ range (.packages.darwin.brews | sortAlpha | uniq) -}}
brew {{ . | quote }}
{{ end -}}

{{ range (.packages.darwin.casks | sortAlpha | uniq) -}}
cask {{ . | quote }}
{{ end -}}
EOF